CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `projects_get_all` AS select `p`.`project_id` AS `project_id`,`p`.`name` AS `name`,`p`.`description` AS `description`,`p`.`size` AS `size`,`p`.`methodology` AS `methodology`,`p`.`translated` AS `translated`,`p`.`classified` AS `classified`,count(distinct `c`.`category_id`) AS `categories_count`,count(distinct `r`.`requirement_id`) AS `requirements_count`,count(distinct `t`.`task_id`) AS `tasks_count`,cast(((select sum(`t`.`percentage_completed`) from `tasks` `t` where `t`.`requirement_id` in (select `requirements`.`requirement_id` from `requirements` where (`requirements`.`project_id` = `p`.`project_id`))) / count(distinct `t`.`task_id`)) as decimal(10,1)) AS `percentage_completed` from (((`projects` `p` left join `categories` `c` on((`p`.`project_id` = `c`.`project_id`))) left join `requirements` `r` on((`p`.`project_id` = `r`.`project_id`))) left join `tasks` `t` on((`r`.`requirement_id` = `t`.`requirement_id`))) group by `p`.`project_id`;
